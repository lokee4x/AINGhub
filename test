-- GUI Creation
local ScreenGui = Instance.new("ScreenGui")
local MainFrame = Instance.new("Frame")
local Title = Instance.new("TextLabel")
local MinimizeButton = Instance.new("TextButton")
local CloseButton = Instance.new("TextButton")
local MinimizedIcon = Instance.new("TextButton")
local Sidebar = Instance.new("Frame")
local MainTab = Instance.new("TextButton")
local ESPTab = Instance.new("TextButton")
local ContentFrame = Instance.new("Frame")
local ESPContentFrame = Instance.new("Frame")
local MainContentFrame = Instance.new("Frame")
local ESPButton = Instance.new("TextButton")
local PathButton = Instance.new("TextButton")

-- Parent GUI to Player
ScreenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Setup GUI Properties
MainFrame.Parent = ScreenGui
MainFrame.BackgroundColor3 = Color3.fromRGB(20, 20, 30)
MainFrame.Size = UDim2.new(0, 300, 0, 200)
MainFrame.Position = UDim2.new(0.3, 0, 0.3, 0)
MainFrame.Active = true
MainFrame.Draggable = true

-- Sidebar Menu
Sidebar.Parent = MainFrame
Sidebar.BackgroundColor3 = Color3.fromRGB(25, 25, 35)
Sidebar.Size = UDim2.new(0.3, 0, 0.85, 0)
Sidebar.Position = UDim2.new(0, 0, 0.15, 0)

-- Main Tab Button
MainTab.Parent = Sidebar
MainTab.Text = "Main"
MainTab.Size = UDim2.new(1, 0, 0.2, 0)
MainTab.BackgroundColor3 = Color3.fromRGB(50, 50, 70)

-- ESP Tab Button
ESPTab.Parent = Sidebar
ESPTab.Text = "ESP"
ESPTab.Size = UDim2.new(1, 0, 0.2, 0)
ESPTab.Position = UDim2.new(0, 0, 0.25, 0)
ESPTab.BackgroundColor3 = Color3.fromRGB(50, 50, 70)

-- Content Frames
ContentFrame.Parent = MainFrame
ContentFrame.Size = UDim2.new(0.7, 0, 0.85, 0)
ContentFrame.Position = UDim2.new(0.3, 0, 0.15, 0)

MainContentFrame.Parent = ContentFrame
MainContentFrame.Size = UDim2.new(1, 0, 1, 0)

ESPContentFrame.Parent = ContentFrame
ESPContentFrame.Size = UDim2.new(1, 0, 1, 0)
ESPContentFrame.Visible = false

-- ESP Button
ESPButton.Parent = ESPContentFrame
ESPButton.Text = "ESP: OFF"
ESPButton.Size = UDim2.new(0.8, 0, 0.3, 0)
ESPButton.Position = UDim2.new(0.1, 0, 0.35, 0)
ESPButton.BackgroundColor3 = Color3.fromRGB(150, 0, 0)

-- Path Button
PathButton.Parent = MainContentFrame
PathButton.Text = "Show Path"
PathButton.Position = UDim2.new(0.1, 0, 0.6, 0)
PathButton.Size = UDim2.new(0.8, 0, 0.2, 0)
PathButton.BackgroundColor3 = Color3.fromRGB(200, 100, 0)

-- ESP Variables
local espEnabled = false
local espObjects = {}

-- Function to Remove All ESP
local function removeESP()
    for _, obj in ipairs(espObjects) do
        if obj then obj:Destroy() end
    end
    espObjects = {}
end

-- Function to Create ESP
local function createESP(player)
    if player.Team == game.Players.LocalPlayer.Team then return end

    local character = player.Character
    if character then
        local head = character:FindFirstChild("Head")
        if head then
            local esp = Instance.new("BillboardGui")
            esp.Adornee = head
            esp.Size = UDim2.new(4, 0, 1, 0)
            esp.StudsOffset = Vector3.new(0, 2, 0)
            esp.AlwaysOnTop = true

            local text = Instance.new("TextLabel", esp)
            text.Size = UDim2.new(1, 0, 1, 0)
            text.Text = player.Name
            text.BackgroundTransparency = 1
            text.TextColor3 = Color3.fromRGB(255, 0, 0)

            esp.Parent = head
            table.insert(espObjects, esp)
        end
    end
end

-- ESP Toggle Function
ESPButton.MouseButton1Click:Connect(function()
    espEnabled = not espEnabled
    ESPButton.Text = espEnabled and "ESP: ON" or "ESP: OFF"
    ESPButton.BackgroundColor3 = espEnabled and Color3.fromRGB(0, 200, 0) or Color3.fromRGB(150, 0, 0)

    if espEnabled then
        for _, player in ipairs(game.Players:GetPlayers()) do
            createESP(player)
        end
    else
        removeESP()
    end
end)

-- Show Path Function
PathButton.MouseButton1Click:Connect(function()
    local wrongModel = game.Workspace:FindFirstChild("wrong")
    local correctModel = game.Workspace:FindFirstChild("Correct")

    if wrongModel then
        for _, part in pairs(wrongModel:GetDescendants()) do
            if part:IsA("BasePart") then
                part.BrickColor = BrickColor.new("Terra Cotta")
            end
        end
    else
        print("Model 'wrong' not found.")
    end

    if correctModel then
        for _, part in pairs(correctModel:GetDescendants()) do
            if part:IsA("BasePart") then
                part.BrickColor = BrickColor.new("Grime")
            end
        end
    else
        print("Model 'Correct' not found.")
    end
end)

-- Tab Switching Logic
MainTab.MouseButton1Click:Connect(function()
    MainContentFrame.Visible = true
    ESPContentFrame.Visible = false
end)

ESPTab.MouseButton1Click:Connect(function()
    MainContentFrame.Visible = false
    ESPContentFrame.Visible = true
end)
